{% extends "base.html" %}
{% load crispy_forms_tags %}

{% block title %}{{ object.title }} - {{ block.super }}{% endblock title %}

{% block main %}
  <h1>{{ object.title }} - {{ object.year }}</h1>
  <p class="lead">
    {{ object.plot }}
  </p>
{% endblock main %}

{% block sidebar %}
  <div>
    <span class="font-weight-bold text-muted">This movie is rated:</span>
    <span class="badge badge-primary">
      {{ object.get_rating_display }}
    </span><br><br>
  </div>

  <div>
    <span class="font-weight-bold text-muted">Director: </span>
    {% if object.director %}
      <a href="{% url 'core:person' object.director.pk %}">{{ object.director }}</a> <br>
    {% endif %}

    <span class="font-weight-bold text-muted">Writers: </span>
    <ul style="list-style: none; margin-left: -20px">
      {% for writer in object.writers.all %}
        <li><a href="{% url 'core:person' writer.pk %}">
          {{ writer.first_name }} {{ writer.last_name }}</a>
        </li>
      {% endfor %}
    </ul>

    <span class="font-weight-bold text-muted">Cast: </span>
    <ul style="list-style: none; margin-left: -20px;">
      {% for actor in object.actors.all %}
        <li>
          <a href="{% url 'core:person' actor.pk %}">{{ actor.first_name }} {{ actor.last_name }}</a>
        </li>
      {% endfor %}
    </ul>

    <span class="font-weight-bold text-muted">Runtime: </span> {{ object.runtime }}
  </div>

  <div>
  <style>
    label[for="id_value_0"] {
      display: none;
    }

    form {
      margin-left: 20px;
    }
  </style>
  <br>
    <p class="font-weight-bold text-muted mb-2">Vote:</p>
    {% if vote_form %}
      <form method="post" action="{{ vote_form_url }}">
        {% csrf_token %}
        {{ vote_form|crispy }}
        <button class="btn btn-primary" type="submit">Vote</button>
      </form>
    {% else %}
      <p><a href="{% url 'user:login' %}">Login</a> to vote for this</p>
    {% endif %}
  </div>
{% endblock sidebar %}
